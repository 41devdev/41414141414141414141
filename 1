local MAIN_SCRIPT_URL = "https://pastebin.com/raw/9v5NHSay"

-- ðŸ”‘ Key validation helpers
local CH = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
local function base36ToDec(str)
    local n=0
    for i=1,#str do
        local c=string.sub(str,i,i)
        local v=string.find(CH,c)-1
        n=n*36+v
    end
    return n
end

local function base36Pad(n,len)
    local out={}
    for i=1,len do
        local digit=n%36
        out[len-i+1]=string.sub(CH,digit+1,digit+1)
        n=math.floor(n/36)
    end
    return table.concat(out)
end

local function checksumBlock(username,head8)
    username=username:upper()
    head8=head8:upper()
    local s=username..head8
    local total=0
    local MOD=36^4
    for i=1,#s do total=(total+string.byte(s,i))%MOD end
    return base36Pad(total,4)
end

local function validateKey(username,key)
    local a,b,c,d=string.match((key or ""):upper(),"^(%w%w%w%w)%-(%w%w%w%w)%-(%w%w%w%w)%-(%w%w%w%w%w%w)$")
    if not a then return false,"Format error" end
    local chk=checksumBlock(username,a..b)
    if chk~=c then return false,"Checksum mismatch" end
    local expireAt=base36ToDec(d)
    if os.time()>expireAt then return false,"Expired" end
    return true,"OK"
end

-- ðŸš€ Direct bypass via getgenv().script_key
if getgenv and getgenv().script_key then
    local userKey = tostring(getgenv().script_key)
    local ok, msg = validateKey(game.Players.LocalPlayer.Name, userKey)
    if ok then
        loadstring(game:HttpGet(MAIN_SCRIPT_URL))()
    else
        warn("Invalid script_key: "..tostring(msg))
    end
else
    warn("No script_key set in environment")
end
